# juniferest

Just an example of Isolation Forest realization in Julia. Этот репозиторий будет для экспериментов.

### Цели

* Прояснить, в каком формате должен происходить поиск аномалий.
* Научить изофорест нормальному обучению с целью поиска этих аномалий.
* Попробовать сделать сам изофорест лучше. Не теряя его положительных качеств.


### Вопросы

* Глобально -- почему вообще изофорест работает?
* Какое обоснование математическое можно ему дать?
* Что можно извлечь из изофореста помимо редких точек?
* Как можно проводить обучение с подкреплением?
* Какие при этом у обучения с подкреплением будут математические интерпретации?
* Можно ли научиться отличать редкие данные от аномальных? Хвосты и иррегулярности -- разные вещи.
* Пусть даже в хвостах больше концентрация аномалий, то есть фичи хорошие. Но тогда как отрезать интересные аномалии от неинтересных?
* Какова вероятностная интерпретация отсеивания деревьев?


### Идеи

Идеи просто про сами деревья:

* Можно считать по-другому скоры в листьях деревьев. Вариантов множество.
* Может не просто так считаем среднюю глубину? Возможно, что имеет смысл именно произведение разных распределений брать -- какой-то аналог правдоподобия.
* Можно отталкиваться от разных бб -- сабдаты или носителя. бб -- bounding box.
* Можно запоминать бб -- для использования в вычислении скоров (или ещё чего).
* При делении можно сохранять весь бб, а можно только по конкретной фиче.
* При построении дерева можно делить рандомом, можно делить пополам. Делить есть возможность по разным бб.
* Можно использовать для каких-то целей объём -- посчитанный через бб.
* При подсчёте скоров (или ещё чего) можно опираться не только на трешолд, но и на бб.
* Можно семплить из деревьев. Причём куча вариантов.
* Можно аппроксимировать плотность вероятности по деревьям. Прям считать значения.
* Можно визуализировать деревья, т.к. их на самом деле можно складывать и делить. И это имеет конкретные вероятностные интерпретации.
* Имеет смысл рассмотреть не только суммирование и умножение, но и взятие минимумов с максимумами. Уж больно построение аппроксимации распределения в изофоросте похоже на лебеговский подход к построению меры. Берём некоторые значения по уровням и потом по ним ищем подходящие множества. Но не стоит ограничиваться одной попыткой, связь может быть сложнее.
* Так же надо глянуть на интерпретацию меры по Рису -- там тоже могут параллели лежать, что даст намёков на правильное использование деревьев.
* Можно попробовать на типичных распределениях (двумерных для наглядности) построить деревья и потом каким-либо способ посмотреть на них -- визуализировать, засемплить или просто оценить плотность вероятности.
* Следует задуматься о нормировке. Пока очень не очевидно, как можно проводить нормировку. Можно на конкретных гауссианах поупражняться.

Идеи про фильтрацию и скоры:

* Маню выдал хорошее направление -- считать KL-метрику вместо адхока всякого.
* Можно по KL фильтровать деревья.
* Можно по KL пытаться искать действительно аномалии. Вопрос в том, по каким распределениям. Вполне возможно, что удастся и из центра распределения их достать.
* Можно семплить из деревьев и на семплах строить новые деревья.
* Можно собирать статистики на деревьях и строить новые деревья по этим статистикам. По фичам и по трешолдам.
* Можно в процессе построения дерева использовать другие деревья. Например, скооперировать выборку из текущего бб с расчётом скоров по другим деревьям. Но это не единственный вариант. Их много.
* Можно выращивать деревья разной глубины. Например, можно начать процесс обучения с неглубоких, типа глубиной 5-6. А когда мы получим пару откликов от эксперта, тогда уже углублять ветки. Эти же ветки можно и отрезать, выкидывать, если они не очень удачные. Этот процесс можно проводить одновременно. Одни ветки резать, другие наращивать. Отжигая потихоньку.
* Можно комбинировать фрагменты разных деревьев. Спускаясь по одному дереву в какой-нибудь лист, мы попадаем в определённый параллелипипед фазового пространства. Потом проходим этим параллелипипедом по всем другим деревьям и находим пути, которые этот параллелипипед режут на части. Вот и новые бранчи.

### Задачи

TBD

* Подбить все идеи, какие только есть.
* Обозреть литературу: взять Н самых цитируемых статей, цитирующих оригинальную статью по изофоресту. Поискать книги.
* Выбрать датасеты?
* ...
